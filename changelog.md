## Changelog


### Version 2.1.4 (2023-10-05)
- Исправлено:
  - добавлены недостающие изображения категорий для дайджеста King


### Version 2.1.3 (2023-10-05)
- Исправлено:
  - поправлен путь в config файле


### Version 2.1.2 (2023-09-29)
- Исправлено:
  - в дайджестах king/mix поправлены линки по комментам продукта
  - в дайджесте king добавлены поля под текст кнопок и поправлены плашки категорий


### Version 2.1.1 (2023-08-31)
- Новые реализации:
  - добавлен шаблон под Царь-дайджест
  - в digests.js добавлен новый маркер texts (наличие текста у каждого события; требуется для Царь-дайджеста)
  - добавлен раздел под промо-письмо (требуется обсуждение формата; в прод не введен)
  - добавлен блок с текстами кнопок для Царь-дайджеста (требуется обсуждение формата; в прод не введен)
- Улучшения:
  - кодстайл и нейминг переменных
- Исправлено:
  - перенос в кнопке "царь-дайджест" вылечен неразрывным дефисом
- TODO:
  - Переписать JS (упростить и минимизировать код)
  - добавить доступ к старой версии дайджеста MIX


### Version 2.0.0 (2023-08-21)
- Новые реализации:
  - работа всего автосборщика унифицирована: методы и формы приведены к общему знаменателю и теперь это база для парсинга событий и визуализации этой информации в любых согласованных формах
  - все методы (Python, JS, HTML) работы с mix приведены к связке запроса на новый эндпоинт digest с параметром digestType
  - тип дайджеста указывается в параметре (digestType) запроса на новый эндпоинт (для переиспользования кода соответствует названию файла верстки)
  - отрисовка форм и полей теперь происходит посредством JS при выборе типа коммуникации, а не задается заранее в html
- Новые функции:
  - в новых файлах JS реализована общая логика построения и визуализации форм, а также валидация полей и обращение к серверу
  - JS дайджестов вынесено в digests.js
  - JS события вынесено в event.js
- Улучшения:
  - служебные функции вынесены из init в tools.py
  - методы/слушатели для реализации темной темы вынесены в dark-theme.js (переиспользование между страницами эндпоинтов)
  - обработка ссылок событий для формирования объекта Event вынесена в отдельную функцию
  - стилями реализована анимация плавного переключения между формами, т. к. отрисовка при помощи JS моментальна, что "режет" взгляд
- Новые эндпоинты:
  - mix заменен на эндпоинт более широкого формата digest с параметром digestType
- Исправлено:
  - дизайн changelog страницы приведен в соответствие общему стилю
  - реализовано автоопределение темной темы в changelog
  - кодстайл и нейминг


### Version 1.5.14 (2023-08-18)
- Улучшения:
  - добавлена иконка инструмента и с нее ссылка на журнал изменений (через слушатель в JS)
  - в html форме для New MIX добавлено поле под ссылку на изображение заголовка (скрывается от просмотра и валидации при выборе Old MIX)
- Исправлено:
  - цвет плашки скидок в New MIX html приведен в нужный оттенок
  - просачивание нового формата скидки в старый html MIX решено зачисткой данных нового формата при их реализации в старой форме
  - уточнены стили темной темы для editable-input


### Version 1.5.13 (2023-08-18)
- Исправлено:
  - возврат к удобству Blueprint
- Тестирование:
  - тест GitHub WebHook


### Version 1.5.12 (2023-08-18)
- Новая функция:
  - get_config_data / find_config_file - реализовано то, что анонсировано и опробовано ранее
- Улучшения:
  - переменная с повторяющимся значением prefix_path вынесена в аргументы функций и инициализируется только в главном модуле
- Исправлено:
  - доработан механизм работы с config.yaml


### Version 1.5.11 (2023-08-18)
- Улучшения:
  - объединены view & get _changelog функции. Разница теперь только в параметре запроса (запрос контента changelogType)
  - парсинг changelog вынесен в отдельный модуль и разделен на отдельные функции
  - в html журнала изменений добавлено переключение между уровнями версий и к ним добавлены слушатели и обработка в JS
- Исправлено:
  - парсинг changelog доработан: корректно разделяются по группам изменений версии и ищутся изменения по ним


### Version 1.5.10 (2023-08-18)
- Исправлено:
  - путь к changelog файлу


### Version 1.5.9 (2023-08-18)
- Улучшения:
  - разделен .sh на update и restart для получения промежуточного результата обновления
  - под каждый из .sh создан свой отдельный поток
  - добавлен параметр changelogType, определяющий полноту запрашиваемых данных из журнала изменений
- Тестирование:
  - тест GitHub WebHook


### Version 1.5.8 (2023-08-18)
- Тестирование:
  - тест GitHub WebHook


### Version 1.5.7 (2023-08-18)
- Исправлено:
  - путь к config файлу


### Version 1.5.6 (2023-08-18)
- Тестирование:
  - тест GitHub WebHook


### Version 1.5.5 (2023-08-18)
- Исправлено:
  - убрана функция инициализации по config файлу


### Version 1.5.4 (2023-08-18)
- Исправлено:
  - стартовое значение переменной


### Version 1.5.3 (2023-08-18)
- Исправлено:
  - стартовое значение переменных окружения


### Version 1.5.2 (2023-08-18)
- Исправлено:
  - путь в [config](config.yaml) файле


### Version 1.5.1 (2023-08-18)
- Улучшения:
  - попытка реализации отправки актуальной версии в ответе на webhook GitHub
  - запись актуальной версии вынесена в .sh
- Исправлено:
  - повторная попытка реализации config файла, но сейчас через yaml
  - кодстайл


### Version 1.5.0 (2023-08-17)
- Новая функция:
  - is_needed_for_border: автоматическая оценка необходимости наличия границы у изображения (если слишком светлое)
- Зависимости:
  - добавлены cv2 и numpy для обработки и анализа изображения события
- Исправлено:
  - исправлены параметры функции запроса изображения
  - кодстайл в .html


### Version 1.4.3 (2023-08-17)
- Улучшения:
  - реализован поиск жанра для типа событий places
- Исправлено:
  - поправлены условия показа плашки скидки


### Version 1.4.2 (2023-08-17)
- Улучшения
  - реализован просмотр максимального кешбэка и минимальной цены в подборках событий (маркеры places/selections)
  - реализована плашка скидки в .html New MIX
- Исправлено:
  - минорное переименование переменных и кодстайл


### Version 1.4.1 (2023-08-16)
- Улучшения:
  - реализована выборка интервала в событиях с календарным виджетом
- Исправлено:
  - убрано дублирование в журнале истории


### Version 1.4.0 (2023-08-16)
- Улучшения:
  - реализовано сохранение сессии между запросами; ввиду этого random User-Agent создается только 1 раз
- Исправлено:
  - добавлены ссылки к заголовку и плашкам кешбэка в New MIX html


### Version 1.3.0 (2023-08-16)
- Улучшения:
  - автоматически определяется тема пользователя на устройстве и по необходимости включается темная


### Version 1.2.2 (2023-08-16)
- Улучшения:
  - кодстайл


### Version 1.2.1 (2023-08-16)
- Исправлено:
  - верстка new MIX: добавлен is_border и скругления у картинки главного события


### Version 1.2.0 (2023-08-16)
- Новые реализации:
  - в panel.html добавлены кнопки-переключатели для выбора версии дайджеста MIX
  - в отправку запроса из .js добавлен параметр mixType, в котором передается версия дайджеста
  - в .py реализована приемка параметра; в зависимости от него в цепочке вызовов далее будут использованы новые функции (ниже)
  - old_mix_date / new_mix_date собирает старую / новую версию дайджеста
- Исправлено:
  - в make_html_tags добавлено удаление пробелов в начале/конце строк (стали заметны аффекты в новой версии дайджеста MIX)
- Улучшения:
  - get_cashback приведен к единой для обеих версий дайджеста форме
  - в get_/event_parameter/ функциях для исключений изменено значение возвращаемых заглушек на более осмысленное
- TODO:
  - по необходимости привести к новой форме get_discount (по образцу get_cashback)


### Version 1.1.3 (2023-08-14)
- Исправлено:
  - Убрал config.py
- TODO:
  - Все прежние + проверить импорт на сервере


### Version 1.1.2 (2023-08-14)
- Исправлено:
  - Заменил импорт config.py на относительный
- TODO:
  - Все прежние + реализовать вывод обновленной версии программы в webhook GitHub Actions


### Version 1.1.1 (2023-08-14)
- Новая функция:
  - view_changelog: переход на страницу журнала изменений
  - get_changelog: возвращает major/minor изменения в json
- Исправлено:
  - Изменено имя JS функции copy -> copyToClipboard, чтобы избежать рекурсивного вызова в execCommand('copy')
- Улучшения:
  - Реализован журнал изменения версий ChangeLog:
    - Добавлены changelog.md и changelog.html
    - Журнал изменений major/minor версий доступен по новому эндпоинту в отдельном html
    - Добавлены css темной темы для changelog страницы
  - Добавлен config.py
- Новые эндпоинты:
  - /{prefix}/changelog для просмотра журнала изменений
  - /{prefix}/changelog/get для получения журнала изменений (только major/minor) в виде json
- TODO:
  - Посмотреть функцию дат в event: реализовать алгоритм для событий типа 1 с календарным виджетом
  - В panel.html добавить кнопку перехода к журналу изменений
  - В changelog.html добавить фильтрацию по типу изменения версий: minor/major/patch
  - В get_changelog возвращать весь журнал целиком или продумать вариант с параметрами вызова, чтобы сужать объем

